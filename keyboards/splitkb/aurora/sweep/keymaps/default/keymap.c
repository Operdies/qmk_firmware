#include QMK_KEYBOARD_H

/* THIS FILE WAS GENERATED!
 *
 * This file was generated by qmk json2c. You may or may not want to
 * edit it directly.
 */

enum layer_names {
    _HOMEROW,
    _SYMBOLS,
    _MOUSE,
    _ESCAPE_HATCH,
};

enum custom_keycodes {
    _ASSIGN = SAFE_RANGE,
    _AUTOBRACE,
    _AUTOBRACKET,
    _AUTOPAREN,
    _AUTOANGLE,
};

enum combos {
    JK_ESC,
    QWE_ASSIGN,
    AE_AE,
    OE_OE,
    AO_AO,
    RU_PAR,
    EI_BRA,
    WO_BRC,
    TY_ANG,
};

const uint16_t PROGMEM jk_combo[]       = {LSFT_T(KC_J), LCTL_T(KC_K), COMBO_END};
const uint16_t PROGMEM eqassign_combo[] = {KC_Q, KC_W, KC_E, COMBO_END};
const uint16_t PROGMEM ae_combo[]       = {LT(_SYMBOLS, KC_A), KC_E, COMBO_END};
const uint16_t PROGMEM oe_combo[]       = {KC_O, KC_E, COMBO_END};
const uint16_t PROGMEM ao_combo[]       = {LT(_SYMBOLS, KC_A), KC_O, COMBO_END};
const uint16_t PROGMEM ru_combo[]       = {KC_R, KC_U, COMBO_END};
const uint16_t PROGMEM ei_combo[]       = {KC_E, KC_I, COMBO_END};
const uint16_t PROGMEM wo_combo[]       = {KC_W, KC_O, COMBO_END};
const uint16_t PROGMEM ty_combo[]       = {KC_T, KC_Y, COMBO_END};

combo_t key_combos[] = {
    [JK_ESC] = COMBO(jk_combo, KC_ESC),
    [QWE_ASSIGN] = COMBO(eqassign_combo, _ASSIGN),
    [AE_AE] = COMBO(ae_combo, ALGR(KC_Z)),
    [OE_OE] = COMBO(oe_combo, ALGR(KC_L)),
    [AO_AO] = COMBO(ao_combo, ALGR(KC_W)),
    [RU_PAR] = COMBO(wo_combo, _AUTOPAREN),
    [EI_BRA] = COMBO(ei_combo, _AUTOBRACKET),
    [WO_BRC] = COMBO(ru_combo, _AUTOBRACE),
    [TY_ANG] = COMBO(ty_combo, _AUTOANGLE),
};

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
//    ┌─────────────────┬───────────┬───────────┬───────────┬───────────┐                               ┌───────────┬───────────┬───────────┬───────────┬─────────────────┐
//    │        q        │     w     │     e     │     r     │     t     │                               │     y     │     u     │     i     │     o     │        p        │
//    ├─────────────────┼───────────┼───────────┼───────────┼───────────┤                               ├───────────┼───────────┼───────────┼───────────┼─────────────────┤
//    │ LT(_SYMBOLS, a) │ LALT_T(s) │ LCTL_T(d) │ LSFT_T(f) │ LGUI_T(g) │                               │ LGUI_T(h) │ LSFT_T(j) │ LCTL_T(k) │ LALT_T(l) │ LT(_SYMBOLS, ;) │
//    ├─────────────────┼───────────┼───────────┼───────────┼───────────┤                               ├───────────┼───────────┼───────────┼───────────┼─────────────────┤
//    │        z        │     x     │     c     │     v     │     b     │                               │     n     │     m     │     ,     │     .     │        /        │
//    └─────────────────┴───────────┴───────────┴───────────┼───────────┼─────┐   ┌─────────────────────┼───────────┼───────────┴───────────┴───────────┴─────────────────┘
//                                                          │   bspc    │ tab │   │ LT(MO(_MOUSE), ent) │    spc    │
//                                                          └───────────┴─────┘   └─────────────────────┴───────────┘
[_HOMEROW] = LAYOUT_split_3x5_2(
  KC_Q               , KC_W         , KC_E         , KC_R         , KC_T         ,                                       KC_Y         , KC_U         , KC_I         , KC_O         , KC_P                 ,
  LT(_SYMBOLS, KC_A) , LALT_T(KC_S) , LCTL_T(KC_D) , LSFT_T(KC_F) , LGUI_T(KC_G) ,                                       LGUI_T(KC_H) , LSFT_T(KC_J) , LCTL_T(KC_K) , LALT_T(KC_L) , LT(_SYMBOLS, KC_SCLN),
  KC_Z               , KC_X         , KC_C         , KC_V         , KC_B         ,                                       KC_N         , KC_M         , KC_COMM      , KC_DOT       , KC_SLSH              ,
                                                                    KC_BSPC      , KC_TAB ,     LT(MO(_MOUSE), KC_ENT) , KC_SPC
),

//    ┌───┬──────────────┬──────────────┬──────────────┬───────────┐                             ┌──────┬───────────┬───────────┬───────────┬───┐
//    │ ` │      =       │      -       │      '       │    tab    │                             │  no  │     7     │     8     │     9     │ | │
//    ├───┼──────────────┼──────────────┼──────────────┼───────────┤                             ├──────┼───────────┼───────────┼───────────┼───┤
//    │ ( │ LALT_T(left) │ LCTL_T(down) │ LSFT_T(rght) │ LGUI_T()) │                             │ lgui │ LSFT_T(4) │ LCTL_T(5) │ LALT_T(6) │ \ │
//    ├───┼──────────────┼──────────────┼──────────────┼───────────┤                             ├──────┼───────────┼───────────┼───────────┼───┤
//    │ [ │      ]       │      #       │      {       │     }     │                             │  0   │     1     │     2     │     3     │ = │
//    └───┴──────────────┴──────────────┴──────────────┼───────────┼─────┐   ┌───────────────────┼──────┼───────────┴───────────┴───────────┴───┘
//                                                     │           │     │   │ MO(_ESCAPE_HATCH) │      │
//                                                     └───────────┴─────┘   └───────────────────┴──────┘
[_SYMBOLS] = LAYOUT_split_3x5_2(
  KC_GRAVE , KC_EQL          , KC_MINS         , KC_QUOT         , KC_TAB          ,                                   KC_NO   , KC_7         , KC_8         , KC_9         , KC_PIPE,
  KC_LPRN  , LALT_T(KC_LEFT) , LCTL_T(KC_DOWN) , LSFT_T(KC_RGHT) , LGUI_T(KC_RPRN) ,                                   KC_LGUI , LSFT_T(KC_4) , LCTL_T(KC_5) , LALT_T(KC_6) , KC_BSLS,
  KC_LBRC  , KC_RBRC         , KC_HASH         , KC_LCBR         , KC_RCBR         ,                                   KC_0    , KC_1         , KC_2         , KC_3         , KC_EQL ,
                                                                   KC_TRNS         , KC_TRNS ,     MO(_ESCAPE_HATCH) , KC_TRNS
),

//    ┌───┬──────┬─────┬──────┬─────┐               ┌──────┬──────┬──────┬──────┬─────┐
//    │ ` │  =   │  -  │  '   │ tab │               │      │ btn1 │ wh_u │ btn2 │     │
//    ├───┼──────┼─────┼──────┼─────┤               ├──────┼──────┼──────┼──────┼─────┤
//    │ ( │ wh_l │     │ wh_r │  )  │               │ ms_l │ ms_d │ ms_u │ ms_r │     │
//    ├───┼──────┼─────┼──────┼─────┤               ├──────┼──────┼──────┼──────┼─────┤
//    │ [ │  ]   │  #  │  {   │  }  │               │      │ wh_l │ wh_d │ wh_r │     │
//    └───┴──────┴─────┴──────┼─────┼─────┐   ┌─────┼──────┼──────┴──────┴──────┴─────┘
//                            │     │     │   │     │      │
//                            └─────┴─────┘   └─────┴──────┘
[_MOUSE] = LAYOUT_split_3x5_2(
  KC_GRAVE , KC_EQL  , KC_MINS , KC_QUOT , KC_TAB  ,                         KC_TRNS , KC_BTN1 , KC_WH_U , KC_BTN2 , KC_TRNS,
  KC_LPRN  , KC_WH_L , KC_TRNS , KC_WH_R , KC_RPRN ,                         KC_MS_L , KC_MS_D , KC_MS_U , KC_MS_R , KC_TRNS,
  KC_LBRC  , KC_RBRC , KC_HASH , KC_LCBR , KC_RCBR ,                         KC_TRNS , KC_WH_L , KC_WH_D , KC_WH_R , KC_TRNS,
                                           KC_TRNS , KC_TRNS ,     KC_TRNS , KC_TRNS
),

//    ┌─────┬──────┬──────┬──────┬─────┐               ┌─────┬────┬────┬────┬─────┐
//    │     │      │  up  │      │     │               │ del │ f7 │ f8 │ f9 │ f10 │
//    ├─────┼──────┼──────┼──────┼─────┤               ├─────┼────┼────┼────┼─────┤
//    │     │ left │ down │ rght │     │               │     │ f4 │ f5 │ f6 │ f11 │
//    ├─────┼──────┼──────┼──────┼─────┤               ├─────┼────┼────┼────┼─────┤
//    │     │      │      │      │     │               │     │ f1 │ f2 │ f3 │ f12 │
//    └─────┴──────┴──────┴──────┼─────┼─────┐   ┌─────┼─────┼────┴────┴────┴─────┘
//                               │     │     │   │     │     │
//                               └─────┴─────┘   └─────┴─────┘
[_ESCAPE_HATCH] = LAYOUT_split_3x5_2(
  KC_TRNS , KC_TRNS , KC_UP   , KC_TRNS  , KC_TRNS ,                         KC_DEL  , KC_F7 , KC_F8 , KC_F9 , KC_F10,
  KC_TRNS , KC_LEFT , KC_DOWN , KC_RIGHT , KC_TRNS ,                         KC_TRNS , KC_F4 , KC_F5 , KC_F6 , KC_F11,
  KC_TRNS , KC_TRNS , KC_TRNS , KC_TRNS  , KC_TRNS ,                         KC_TRNS , KC_F1 , KC_F2 , KC_F3 , KC_F12,
                                           KC_TRNS , KC_TRNS ,     KC_TRNS , KC_TRNS
)
};


bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    static int inc = 10;
    static int h_max = 299;
    static int h_min = 10;

    static int h = 100;
    /* static int s_max = 100; */
    static int s = 70;
    /* static int v_max = 100; */
    static int v = 100;

    if (h >= h_max || h <= h_min)
        inc = -inc;
    h += inc;


    /* s = (s + 1) % s_max; */
    /* h = (h + 1) % h_max; */
    /* v = (v + 1) % v_max; */
    rgblight_sethsv(h, s, v);
    switch (keycode) {
        case _ASSIGN:
            if (record->event.pressed) {
                SEND_STRING(" = ");
            }
            break;
        case _AUTOBRACE:
            if (record->event.pressed) {
                SEND_STRING("{}");
                tap_code16(KC_LEFT);
            }
            break;
        case _AUTOPAREN:
            if (record->event.pressed) {
                SEND_STRING("()");
                tap_code16(KC_LEFT);
            }
            break;
        case _AUTOBRACKET:
            if (record->event.pressed) {
                SEND_STRING("[]");
                tap_code16(KC_LEFT);
            }
            break;
        case _AUTOANGLE:
            if (record->event.pressed) {
                SEND_STRING("<>");
                tap_code16(KC_LEFT);
            }
            break;
        case LGUI_T(KC_RPRN):
            if (record->tap.count && record->event.pressed) {
                tap_code16(KC_RPRN); // Send KC_RPRN on tap
                return false;        // Return false to ignore further processing of key
            }
            break;
    }
    return true;
}

void keyboard_pre_init_user(void) {
    // Set our LED pin as output
    setPinOutput(24);
    // Turn the LED off
    // (Due to technical reasons, high is off and low is on)
    writePinHigh(24);
}

void keyboard_post_init_user(void) {
    rgblight_sethsv(190, 22, 73);
}

